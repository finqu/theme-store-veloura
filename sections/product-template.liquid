{%- capture sectionContent -%}

    {% if request.uri contains 'create_review=true' and product.customer_has_reviewed == false and product.reviews_are_enabled %}

        <div class="product-create-review-layout">

            {% form 'review', product id: 'product-review-form' %}

                <div class="mb-4 form-floating">

                    <input
                        name="name"
                        type="text"
                        id="product-review-name"
                        class="form-control"
                        placeholder="{{ 'general.name' | t }}"
                        value="{{ form.submitted.name | escape }}"
                        required>

                    <label for="product-review-name">
                        {{- 'general.name' | t -}}
                    </label>

                </div>

                <div class="mb-4 form-floating">

                    <input
                        name="title"
                        type="text"
                        id="product-review-title"
                        class="form-control"
                        placeholder="{{ 'general.title' | t }}"
                        value="{{ form.submitted.title | escape }}"
                        required>

                    <label for="product-review-title">
                        {{- 'general.title' | t -}}
                    </label>

                </div>

                <div class="mb-4 form-floating">

                    <textarea
                        id="product-review-comment"
                        name="comment"
                        class="form-control"
                        placeholder="{{ 'product.write_review' | t }}"
                        value="{{ form.submitted.comment | escape }}"
                        required></textarea>

                    <label for="product-review-comment">
                        {{- 'product.write_review' | t -}}
                    </label>

                </div>

                <div class="mb-4 d-flex justify-content-between align-items-center">

                    <span class="h5 mb-0">
                        {{- 'product.review_grade' | t -}}
                    </span>

                    <fieldset class="product-review-rating ms-2">

                        <input
                            type="radio"
                            id="product-review-rating-5"
                            name="rating"
                            value="5"
                            {% if form.submitted.rating | escape == '5' %}checked{% endif %}>
                        <label for="product-review-rating-5" title="5">
                            {%- render 'icon', icon: 'rating', class: 'svg-icon-fill' -%}
                        </label>

                        <input
                            type="radio"
                            id="product-review-rating-4"
                            name="rating"
                            value="4"
                            {% if form.submitted.rating | escape == '4' %}checked{% endif %}>
                        <label for="product-review-rating-4" title="4">
                            {%- render 'icon', icon: 'rating', class: 'svg-icon-fill' -%}
                        </label>

                        <input
                            type="radio"
                            id="product-review-rating-3"
                            name="rating"
                            value="3"
                            {% if form.submitted.rating | escape == '3' %}checked{% endif %}>
                        <label for="product-review-rating-3" title="3">
                            {%- render 'icon', icon: 'rating', class: 'svg-icon-fill' -%}
                        </label>

                        <input
                            type="radio"
                            id="product-review-rating-2"
                            name="rating"
                            value="2"
                            {% if form.submitted.rating | escape == '2' %}checked{% endif %}>
                        <label for="product-review-rating-2" title="2">
                            {%- render 'icon', icon: 'rating', class: 'svg-icon-fill' -%}
                        </label>

                        <input
                            type="radio"
                            id="product-review-rating-1"
                            name="rating"
                            value="1"
                            {% if form.submitted.rating | escape == '1' %}checked{% endif %}>
                        <label for="product-review-rating-1" title="1">
                            {%- render 'icon', icon: 'rating', class: 'svg-icon-fill' -%}
                        </label>

                    </fieldset>

                </div>

                {% render 'form-error', error: form.error, class: 'mb-4' %}

                <div class="mb-4 text-end mb-0">

                    <button type="submit" class="btn btn-primary">{{ 'general.submit' | t }}</button>

                </div>

            {% endform %}

        </div>

    {% else %}

        {%- if store.customer_accounts_require_approval == true and customer.has_access -%}
            {%- assign accountHasApproval = true -%}
        {%- endif -%}

        {%- if section.settings.customDisplayInformation == true and section.settings.showManufacturer and product.manufacturer -%}
            {%- assign showManufacturer = true -%}
        {%- elsif settings.productShowManufacturer == true and product.manufacturer -%}
            {%- assign showManufacturer = true -%}
        {%- endif -%}

        {%- if section.settings.customDisplayInformation == true and section.settings.showPromotion and product.promotion -%}
            {%- assign showPromotion = true -%}
        {%- elsif settings.productShowPromotion == true and product.promotion -%}
            {%- assign showPromotion = true -%}
        {%- endif -%}

        {%- if section.settings.customDisplayInformation == true and section.settings.showNewBadge -%}
            {%- assign showNewBadge = true -%}
        {%- elsif settings.productShowNewBadge == true -%}
            {%- assign showNewBadge = true -%}
        {%- endif -%}

        {%- if section.settings.customDisplayInformation == true and section.settings.showDiscountBadge -%}
            {%- assign showDiscountBadge = true -%}
        {%- elsif settings.productShowDiscountBadge == true -%}
            {%- assign showDiscountBadge = true -%}
        {%- endif -%}

        {%- if section.settings.customDisplayInformation == true and section.settings.showOutOfStockBadge -%}
            {%- assign showOutOfStockBadge = true -%}
        {%- elsif settings.productShowOutOfStockBadge == true -%}
            {%- assign showOutOfStockBadge = true -%}
        {%- endif -%}

        {%- if section.settings.customDisplayInformation == true and section.settings.showStockBalance -%}
            {%- assign showStockBalance = true -%}
        {%- elsif settings.productShowStockBalance == true -%}
            {%- assign showStockBalance = true -%}
        {%- endif -%}

        <div class="position-relative">

            <div class="row row-cols-1 w-md-50">

                <div class="col">

                    <div class="section-highlight-item product-media-container">

                        <div class="product-media row g-0">

                            <div id="product-thumb-media-swiper" class="swiper swiper-vertical d-none d-lg-block col max-w-15 me-5 p-0">

                                <div class="swiper-wrapper">

                                    {%- assign hasMediaImg = false -%}

                                    {% if settings.productImageAspectRatio == '9:13' %}
                                        {%- assign imgSize = '132,182' -%}
                                    {% elsif settings.productImageAspectRatio == '4:3' %}
                                        {%- assign imgSize = '122,104' -%}
                                    {% elsif settings.productImageAspectRatio == '1:1' %}
                                        {%- assign imgSize = '132,132' -%}
                                    {% endif %}

                                    {% for media in product.media %}

                                        {% if media.type == "image" %}

                                            <div class="swiper-slide aspect-ratio-product">

                                                <div class="aspect-ratio-container">

                                                    {%- unless hasMediaImg -%}
                                                        {%- assign hasMediaImg = true -%}
                                                    {%- endunless -%}

                                                    {% if media.thumb %}

                                                        <img
                                                            class="lazy d-block mx-auto img-fluid aspect-ratio-item cursor-pointer"
                                                            alt="{{ product.name }}"
                                                            data-src="{{ media.thumb | thumb: imgSize }}"
                                                            data-srcset="{{ media.thumb | thumb: imgSize }} 1x, {{ media.thumb | thumb: imgSize | thumb: '@2x' }} 2x">

                                                    {% else %}

                                                        {%- capture imgSrc -%}
                                                            {% render 'placeholder-svg', type: 'image', base64: true %}
                                                        {%- endcapture -%}

                                                        <img
                                                            class="lazy d-block mx-auto img-fluid aspect-ratio-item cursor-pointer svg-placeholder"
                                                            alt="{{ product.name }}"
                                                            data-src="{{ imgSrc }}">

                                                    {% endif %}

                                                </div>

                                            </div>

                                        {% endif %}

                                    {% endfor %}

                                    {% if product.attributes.size > 0 %}

                                        {% for attribute in product.attributes %}

                                            {% for option in attribute.options %}

                                                {% if option.image %}

                                                    {%- unless hasMediaImg -%}
                                                        {%- assign hasMediaImg = true -%}
                                                    {%- endunless -%}

                                                    <div class="swiper-slide aspect-ratio-product" data-product-option-image="{{ option.id }}">

                                                        <div class="aspect-ratio-container">

                                                            {% if option.image %}

                                                                <img
                                                                    class="lazy d-block mx-auto img-fluid aspect-ratio-item cursor-pointer"
                                                                    alt="{{ product.name }}"
                                                                    data-src="{{ option.image | thumb: imgSize }}"
                                                                    data-srcset="{{ option.image | thumb: imgSize }} 1x, {{ option.image | thumb: imgSize | thumb: '@2x' }} 2x">

                                                            {% else %}

                                                                {%- capture imgSrc -%}
                                                                    {% render 'placeholder-svg', type: 'image', base64: true %}
                                                                {%- endcapture -%}

                                                                <img
                                                                    class="lazy d-block mx-auto img-fluid aspect-ratio-item cursor-pointer svg-placeholder"
                                                                    alt="{{ product.name }}"
                                                                    data-src="{{ imgSrc }}">

                                                            {% endif %}

                                                        </div>

                                                    </div>

                                                {% endif %}

                                                {% if option.subattribute %}

                                                    {% for option in option.subattribute.options %}

                                                        {% if option.image %}

                                                            {%- unless hasMediaImg -%}
                                                                {%- assign hasMediaImg = true -%}
                                                            {%- endunless -%}

                                                            <div class="swiper-slide aspect-ratio-product" data-product-option-image="{{ option.id }}">

                                                                <div class="aspect-ratio-container">

                                                                    {% if option.image %}

                                                                        <img
                                                                            class="lazy d-block mx-auto img-fluid aspect-ratio-item cursor-pointer"
                                                                            alt="{{ product.name }}"
                                                                            data-src="{{ option.image | thumb: imgSize }}"
                                                                            data-srcset="{{ option.image | thumb: imgSize }} 1x, {{ option.image | thumb: imgSize | thumb: '@2x' }} 2x">

                                                                    {% else %}

                                                                        {%- capture imgSrc -%}
                                                                            {% render 'placeholder-svg', type: 'image', base64: true %}
                                                                        {%- endcapture -%}

                                                                        <img
                                                                            class="lazy d-block mx-auto img-fluid aspect-ratio-item cursor-pointer svg-placeholder"
                                                                            alt="{{ product.name }}"
                                                                            data-src="{{ imgSrc }}">

                                                                    {% endif %}

                                                                </div>

                                                            </div>

                                                        {% endif %}

                                                    {% endfor %}

                                                {% endif %}

                                            {% endfor %}

                                        {% endfor %}

                                    {% endif %}

                                    {% unless hasMediaImg %}

                                        <div class="swiper-slide aspect-ratio-product">

                                            <div class="aspect-ratio-container">

                                                {%- capture imgSrc -%}
                                                    {% render 'placeholder-svg', type: 'image', base64: true %}
                                                {%- endcapture -%}

                                                <img
                                                    class="lazy d-block mx-auto img-fluid aspect-ratio-item cursor-pointer svg-placeholder"
                                                    alt="{{ product.name }}"
                                                    data-src="{{ imgSrc }}">

                                            </div>

                                        </div>

                                    {% endunless %}

                                    {% for media in product.media %}

                                        {% if media.type == "video" %}

                                            <div class="swiper-slide aspect-ratio-product">

                                                <div class="aspect-ratio-container">

                                                    {% if media.thumb %}

                                                        <img
                                                            class="lazy d-block mx-auto img-fluid cursor-pointer aspect-ratio-item"
                                                            alt="{{ product.name }}"
                                                            data-src="{{ media.thumb | thumb: imgSize }}"
                                                            data-srcset="{{ media.thumb | thumb: imgSize }} 1x, {{ media.thumb | thumb: imgSize | thumb: '@2x' }} 2x">

                                                    {% else %}

                                                        {%- capture imgSrc -%}
                                                            {% render 'placeholder-svg', type: 'image', base64: true %}
                                                        {%- endcapture -%}

                                                        <img
                                                            class="lazy d-block mx-auto img-fluid cursor-pointer aspect-ratio-item svg-placeholder"
                                                            alt="{{ product.name }}"
                                                            data-src="{{ imgSrc }}">

                                                    {% endif %}

                                                </div>

                                            </div>

                                        {% endif %}

                                    {% endfor %}

                                </div>

                                <div class="swiper-button-prev">
                                    {%- render 'icon', icon: 'angle-left' -%}
                                </div>

                                <div class="swiper-button-next">
                                    {%- render 'icon', icon: 'angle-right' -%}
                                </div>

                            </div>

                            <div id="product-main-media-swiper" class="swiper swiper-navigation-hide-on-desktop gallery col">

                                {% render 'product-badges', product: product, position: 'top-left', showNew: showNewBadge, showDiscount: showDiscountBadge, showOutOfStock: showOutOfStockBadge %}

                                <div class="swiper-wrapper">

                                    {%- assign hasMediaImg = false -%}

                                    {% if settings.productImageAspectRatio == '9:13' %}

                                        {%- assign imgSizeSm = '555,792' -%}
                                        {%- assign imgSizeMd = '747,1070' -%}
                                        {%- assign imgSizeLg = '574,820' -%}

                                    {% elsif settings.productImageAspectRatio == '4:3' %}

                                        {%- assign imgSizeSm = '555,421' -%}
                                        {%- assign imgSizeMd = '747,565' -%}
                                        {%- assign imgSizeLg = '574,435' -%}

                                    {% elsif settings.productImageAspectRatio == '1:1' %}

                                        {%- assign imgSizeSm = '555,555' -%}
                                        {%- assign imgSizeMd = '747,747' -%}
                                        {%- assign imgSizeLg = '574,574' -%}

                                    {% endif %}

                                    {% for media in product.media %}

                                        {% if media.type == "image" %}

                                            {%- unless hasMediaImg -%}
                                                {%- assign hasMediaImg = true -%}
                                            {%- endunless -%}

                                            <div class="swiper-slide gallery-item aspect-ratio-product">

                                                <div class="product-media-img-container aspect-ratio-container" data-gallery-init>

                                                    {% if media.thumb %}

                                                        <picture>
                                                            <source media="(min-width: {{ settings.styleGridBreakpointLg }})" data-srcset="
                                                                {{- media.thumb | thumb: imgSizeLg }} 1x,
                                                                {{- media.thumb | thumb: imgSizeLg | thumb:'@2x' }} 2x">

                                                            <source media="(min-width: {{ settings.styleGridBreakpointSm }})" data-srcset="
                                                                {{- media.thumb | thumb: imgSizeMd }} 1x,
                                                                {{- media.thumb | thumb: imgSizeMd | thumb:'@2x' }} 2x">

                                                            <source data-srcset="
                                                                {{- media.thumb | thumb: imgSizeSm }} 1x,
                                                                {{- media.thumb | thumb: imgSizeSm | thumb:'@2x' }} 2x">

                                                            <img
                                                                class="lazy lazy-disable-transition d-block mx-auto img-fluid aspect-ratio-item cursor-zoom-in{% if settings.productImageAspectRatio == '9:13' %} aspect-ratio-item-position-top{% endif %}"
                                                                alt="{{ product.name }}"
                                                                data-gallery-img-src="{{ media.original }}"
                                                                src="{{ media.thumb | thumb: imgSizeSm }}">
                                                        </picture>

                                                    {% else %}

                                                        {%- capture imgSrc -%}
                                                            {% render 'placeholder-svg', type: 'image', base64: true %}
                                                        {%- endcapture -%}

                                                        <img
                                                            class="lazy lazy-disable-transition d-block mx-auto img-fluid aspect-ratio-item cursor-zoom-in svg-placeholder"
                                                            alt="{{ product.name }}"
                                                            data-gallery-img-src="{{ imgSrc }}"
                                                            data-src="{{ imgSrc }}">

                                                    {% endif %}

                                                </div>

                                            </div>

                                        {% endif %}

                                    {% endfor %}

                                    {% if product.attributes.size > 0 %}

                                        {% for attribute in product.attributes %}

                                            {% for option in attribute.options %}

                                                {% if option.image %}

                                                    {%- unless hasMediaImg -%}
                                                        {%- assign hasMediaImg = true -%}
                                                    {%- endunless -%}

                                                    <div class="swiper-slide gallery-item aspect-ratio-product" data-product-option-image="{{ option.id }}">

                                                        <div class="product-media-img-container aspect-ratio-container" data-gallery-init>

                                                            {% if option.image %}

                                                                <picture>
                                                                    <source media="(min-width: {{ settings.styleGridBreakpointLg }})" data-srcset="
                                                                        {{- option.image | thumb: imgSizeLg }} 1x,
                                                                        {{- option.image | thumb: imgSizeLg | thumb:'@2x' }} 2x">

                                                                    <source media="(min-width: {{ settings.styleGridBreakpointSm }})" data-srcset="
                                                                        {{- option.image | thumb: imgSizeMd }} 1x,
                                                                        {{- option.image | thumb: imgSizeMd | thumb:'@2x' }} 2x">

                                                                    <source data-srcset="
                                                                        {{- option.image | thumb: imgSizeSm }} 1x,
                                                                        {{- option.image | thumb: imgSizeSm | thumb:'@2x' }} 2x">

                                                                    <img
                                                                        class="lazy lazy-disable-transition d-block mx-auto img-fluid aspect-ratio-item cursor-zoom-in{% if settings.productImageAspectRatio == '9:13' %} aspect-ratio-item-position-top{% endif %}"
                                                                        alt="{{ product.name }}"
                                                                        data-gallery-img-src="{{ option.image }}"
                                                                        src="{{ option.image | thumb: imgSizeSm }}">
                                                                </picture>

                                                            {% else %}

                                                                {%- capture imgSrc -%}
                                                                    {% render 'placeholder-svg', type: 'image', base64: true %}
                                                                {%- endcapture -%}

                                                                <img
                                                                    class="lazy lazy-disable-transition d-block mx-auto img-fluid aspect-ratio-item cursor-zoom-in svg-placeholder"
                                                                    alt="{{ product.name }}"
                                                                    data-gallery-img-src="{{ imgSrc }}"
                                                                    data-src="{{ imgSrc }}">

                                                            {% endif %}

                                                        </div>

                                                    </div>

                                                {% endif %}

                                                {% if option.subattribute %}

                                                    {% for option in option.subattribute.options %}

                                                        {% if option.image %}

                                                            {%- unless hasMediaImg -%}
                                                                {%- assign hasMediaImg = true -%}
                                                            {%- endunless -%}

                                                            <div class="swiper-slide gallery-item aspect-ratio-product" data-product-option-image="{{ option.id }}">

                                                                <div class="product-media-img-container aspect-ratio-container" data-gallery-init>

                                                                    {% if option.image %}

                                                                        <picture>
                                                                            <source media="(min-width: {{ settings.styleGridBreakpointLg }})" data-srcset="
                                                                                {{- option.image | thumb: imgSizeLg }} 1x,
                                                                                {{- option.image | thumb: imgSizeLg | thumb:'@2x' }} 2x">

                                                                            <source media="(min-width: {{ settings.styleGridBreakpointSm }})" data-srcset="
                                                                                {{- option.image | thumb: imgSizeMd }} 1x,
                                                                                {{- option.image | thumb: imgSizeMd | thumb:'@2x' }} 2x">

                                                                            <source data-srcset="
                                                                                {{- option.image | thumb: imgSizeSm }} 1x,
                                                                                {{- option.image | thumb: imgSizeSm | thumb:'@2x' }} 2x">

                                                                            <img
                                                                                class="lazy lazy-disable-transition d-block mx-auto img-fluid aspect-ratio-item cursor-zoom-in{% if settings.productImageAspectRatio == '9:13' %} aspect-ratio-item-position-top{% endif %}"
                                                                                alt="{{ product.name }}"
                                                                                data-gallery-img-src="{{ option.image }}"
                                                                                src="{{ option.image | thumb: imgSizeSm }}">
                                                                        </picture>

                                                                    {% else %}

                                                                        {%- capture imgSrc -%}
                                                                            {% render 'placeholder-svg', type: 'image', base64: true %}
                                                                        {%- endcapture -%}

                                                                        <img
                                                                            class="lazy lazy-disable-transition d-block mx-auto img-fluid aspect-ratio-item cursor-zoom-in svg-placeholder"
                                                                            alt="{{ product.name }}"
                                                                            data-gallery-img-src="{{ imgSrc }}"
                                                                            data-src="{{ imgSrc }}">

                                                                    {% endif %}

                                                                </div>

                                                            </div>

                                                        {% endif %}

                                                    {% endfor %}

                                                {% endif %}

                                            {% endfor %}

                                        {% endfor %}

                                    {% endif %}

                                    {% unless hasMediaImg %}

                                        <div class="swiper-slide gallery-item aspect-ratio-product">

                                            <div class="product-media-img-container aspect-ratio-container" data-gallery-init>

                                                {%- capture imgSrc -%}
                                                    {% render 'placeholder-svg', type: 'image', base64: true %}
                                                {%- endcapture -%}

                                                <img
                                                    class="lazy lazy-disable-transition d-block mx-auto img-fluid aspect-ratio-item cursor-zoom-in svg-placeholder{% if settings.productImageAspectRatio == '9:13' %} aspect-ratio-item-position-top{% endif %}"
                                                    alt="{{ product.name }}"
                                                    data-gallery-img-src="{{ imgSrc }}"
                                                    data-src="{{ imgSrc }}">

                                            </div>

                                        </div>

                                    {% endunless %}

                                    {% for media in product.media %}

                                        {% if media.type == "video" %}

                                            <div class="swiper-slide gallery-item">

                                                <div class="aspect-ratio-product">

                                                    <div class="product-media-video-container aspect-ratio-container" data-gallery-init>

                                                        {% if media.thumb %}

                                                            <div class="product-media-video-icon-container cursor-zoom-in">
                                                                {%- render 'icon', icon: 'play', class: 'svg-icon-fw product-media-video-icon' -%}
                                                            </div>

                                                            <picture>
                                                                <source media="(min-width: {{ settings.styleGridBreakpointLg }})" data-srcset="
                                                                    {{- media.thumb | thumb: imgSizeLg }} 1x,
                                                                    {{- media.thumb | thumb: imgSizeLg | thumb:'@2x' }} 2x">

                                                                <source media="(min-width: {{ settings.styleGridBreakpointSm }})" data-srcset="
                                                                    {{- media.thumb | thumb: imgSizeMd }} 1x,
                                                                    {{- media.thumb | thumb: imgSizeMd | thumb:'@2x' }} 2x">

                                                                <source data-srcset="
                                                                    {{- media.thumb | thumb: imgSizeSm }} 1x,
                                                                    {{- media.thumb | thumb: imgSizeSm | thumb:'@2x' }} 2x">

                                                                <img
                                                                    class="lazy lazy-disable-transition d-block mx-auto img-fluid aspect-ratio-item cursor-zoom-in{% if settings.productImageAspectRatio == '9:13' %} aspect-ratio-item-position-top{% endif %}"
                                                                    alt="{{ product.name }}"
                                                                    data-gallery-video-src="{{ media.url }}"
                                                                    src="{{ media.thumb | thumb: imgSizeSm }}">
                                                            </picture>

                                                        {% else %}

                                                            {%- capture imgSrc -%}
                                                                {% render 'placeholder-svg', type: 'image', base64: true %}
                                                            {%- endcapture -%}

                                                            <img
                                                                class="lazy lazy-disable-transition d-block mx-auto img-fluid svg-placeholder"
                                                                alt="{{ product.name }}"
                                                                data-src="{{ imgSrc }}"
                                                                data-gallery-video-src="{{ media.url }}"
                                                                data-srcset="{{ imgSrc }}">

                                                        {% endif %}

                                                    </div>

                                                </div>

                                            </div>

                                        {% endif %}

                                    {% endfor %}

                                </div>

                                <div class="swiper-button-prev">
                                    {%- render 'icon', icon: 'angle-left' -%}
                                </div>

                                <div class="swiper-button-next">
                                    {%- render 'icon', icon: 'angle-right' -%}
                                </div>

                                <div class="swiper-pagination swiper-pagination-relative d-md-none"></div>

                            </div>

                        </div>

                    </div>

                </div>

                <div class="col product-info-container w-md-50" data-aos="{{ settings.sectionAnimation }}" data-aos-anchor="#finqu-section-{{ section.id }}">

                    <div class="section-highlight-item product-info mt-4 mt-md-0">

                        <div class="product-name">

                            <h1 class="product-name-text">
                                {{ product.name }}
                            </h1>

                        </div>

                        {% if showManufacturer or product.model or product.gtin %}

                            <div class="d-flex">

                                {% if showManufacturer %}

                                    <div class="product-manufacturer">

                                        <a href="{{ product.manufacturer | link }}" class="text-accent">
                                            {{ product.manufacturer.name }}
                                        </a>

                                    </div>

                                    {% if product.model or product.gtin %}

                                        <div class="border-end mx-3"></div>

                                    {% endif %}

                                {% endif %}

                                {% if product.model %}

                                    <div class="product-model-number">

                                        <span>
                                            {{ product.model }}
                                        </span>

                                    </div>

                                {% endif %}

                                {% if product.model and product.gtin %}

                                    <div class="border-end mx-3"></div>

                                {% endif %}

                                {% if product.gtin %}

                                    <div class="product-gtin">

                                        <span>
                                            {{ product.gtin }}
                                        </span>

                                    </div>

                                {% endif %}

                            </div>

                        {% endif %}

                        {% if product.review_count > 0 and product.reviews_are_enabled %}

                            <div class="product-review-rating mt-3">

                                <button
                                    type="button"
                                    id="product-show-reviews"
                                    class="btn btn-text">

                                    <div class="product-review-icons">

                                        {% for rating in (1..product.max_rating) %}

                                            <div class="product-review-icon">

                                                {% if product.rating >= rating %}

                                                    {%- render 'icon', icon: 'rating', class: 'text-review-icon' -%}

                                                {% else %}

                                                    {%- render 'icon', icon: 'rating-empty', class: 'text-muted' -%}

                                                {% endif %}

                                            </div>

                                        {% endfor %}

                                    </div>

                                    <span class="product-review-text text-muted">
                                        {%- if product.review_count == 1 -%}
                                            {{- 'product.review_count_dynamic' | t: amount: product.review_count -}}
                                        {%- else -%}
                                            {{- 'product.review_count_plural_dynamic' | t: amount: product.review_count -}}
                                        {%- endif -%}
                                    </span>

                                </button>

                            </div>

                        {% endif %}

                        <hr class="my-4">

                        {% if product.related.size > 0 %}

                            {% if settings.productImageAspectRatio == '9:13' %}
                                {%- assign imgSize = '79,108' -%}
                            {% elsif settings.productImageAspectRatio == '4:3' %}
                                {%- assign imgSize = '79,62' -%}
                            {% elsif settings.productImageAspectRatio == '1:1' %}
                                {%- assign imgSize = '75,75' -%}
                            {% endif %}

                            <div class="product-related-items-container my-4">

                                <div class="product-related-items">

                                    {% for relatedItem in product.related %}

                                        {% if relatedItem.is_visible %}

                                            <div class="product-related-item">

                                                <a href="{{ relatedItem | link }}">

                                                    <div class="product-related-item-media aspect-ratio-product">

                                                        <div class="product-related-media-img-container aspect-ratio-container">

                                                            {% if relatedItem.image %}

                                                                <picture>
                                                                    <img
                                                                        alt="{{ relatedItem.name }}"
                                                                        data-src="{{ relatedItem.image | thumb: imgSize }}"
                                                                        data-srcset="{{ relatedItem.image | thumb: imgSize }} 1x, {{ relatedItem.image | thumb: imgSize | thumb: '@2x' }} 2x"
                                                                        class="lazy d-block mx-auto img-fluid aspect-ratio-item">
                                                                </picture>

                                                            {% else %}

                                                                {%- capture imgSrc -%}
                                                                    {% render 'placeholder-svg', type: 'image', base64: true %}
                                                                {%- endcapture -%}

                                                                <img
                                                                    class="lazy d-block mx-auto img-fluid aspect-ratio-item svg-placeholder"
                                                                    alt="{{ relatedItem.name }}"
                                                                    data-src="{{ imgSrc }}">

                                                            {% endif %}

                                                        </div>

                                                    </div>

                                                </a>

                                            </div>

                                        {% endif %}

                                    {% endfor %}

                                </div>

                            </div>

                        {% endif %}

                        {% if store.customer_accounts_enabled == false or store.customer_accounts_optional == true or customer %}

                            {% if store.customer_accounts_require_approval == false or customer.has_access %}

                                {% if product.inventory_policy == 'continue' or product.in_stock and product.only_preview == false %}

                                    <div class="product-form mt-4">

                                        {% form 'product', product %}

                                            <input
                                                type="hidden"
                                                name="product_id"
                                                value="{{ product.id }}">

                                            {% unless section.settings.showQuantitySelect %}
                                                <input
                                                    type="hidden"
                                                    name="quantity"
                                                    value="{{ product.min_amount }}">
                                            {% endunless %}

                                            {% if product.attributes.size > 0 %}

                                                <div class="product-attributes">

                                                    {% assign showOptionPrice = section.settings.showProductOptionPrice %}
                                                    {% assign showOptionTotalPrice = section.settings.showProductOptionTotalPrice %}
                                                    {% assign showOptionStockBalance = section.settings.showProductOptionStockBalance %}
                                                    {% assign inventoryPolicy = product.inventory_policy %}
                                                    {% assign isPreviewProduct = product.only_preview %}
                                                    {% assign unit = product.unit %}

                                                    {% for attribute in product.attributes %}

                                                        {%- if attribute.input_type == 'select' -%}

                                                            {% render 'product-attributes/select', attribute: attribute, showOptionPrice: showOptionPrice, showOptionTotalPrice: showOptionTotalPrice, showOptionStockBalance: showOptionStockBalance, inventoryPolicy: inventoryPolicy, isPreviewProduct: isPreviewProduct, unit: unit, inline: true, highlightLabel: true %}

                                                        {%- elsif attribute.input_type == 'radio' -%}

                                                            {% render 'product-attributes/radio', attribute: attribute, showOptionPrice: showOptionPrice, showOptionTotalPrice: showOptionTotalPrice, showOptionStockBalance: showOptionStockBalance, inventoryPolicy: inventoryPolicy, isPreviewProduct: isPreviewProduct, unit: unit, inline: true, highlightLabel: true, style: 'badge' %}

                                                        {%- elsif attribute.input_type == 'checkbox' -%}

                                                            {% render 'product-attributes/checkbox', attribute: attribute, showOptionPrice: showOptionPrice, showOptionTotalPrice: showOptionTotalPrice, showOptionStockBalance: showOptionStockBalance, inventoryPolicy: inventoryPolicy, isPreviewProduct: isPreviewProduct, unit: unit, inline: true, highlightLabel: true %}

                                                        {%- elsif attribute.input_type == 'text' -%}

                                                            {% render 'product-attributes/text', attribute: attribute, showOptionPrice: showOptionPrice, showOptionTotalPrice: showOptionTotalPrice, showOptionStockBalance: showOptionStockBalance, inventoryPolicy: inventoryPolicy, isPreviewProduct: isPreviewProduct, unit: unit, inline: true, highlightLabel: true %}

                                                        {%- endif -%}

                                                    {% endfor %}

                                                </div>

                                            {% endif %}

                                            {% if store.customer_accounts_require_approval == false or accountHasApproval %}

                                                <div class="product-pricing mb-4 d-md-flex">

                                                    <label class="form-label fw-bold me-2 d-inline-block min-w-px-100">
                                                        {{- 'general.price' | t -}}:
                                                    </label>

                                                    <div class="w-100">

                                                        {% if showPromotion %}

                                                            <div class="product-promotion mb-2">
                        
                                                                <span class="text-sale-price">
                                                                    {{ product.promotion.title | strip }}{% if product.promotion.description %}: {{ product.promotion.description }}{% endif %}
                                                                </span>
                        
                                                            </div>
                        
                                                        {% endif %}

                                                        <div class="product-price-container d-flex">

                                                            {% if product.has_discount %}

                                                                <span class="product-sale-price-text text-sale-price fw-bold me-3" data-product-price-dynamic>
                                                                    {{- settings.taxFreeShopping == true | yepnope: product.net_price, product.price | money_with_currency -}}
                                                                </span>

                                                                <span class="product-price text-decoration-line-through text-muted me-3" data-product-original-price-dynamic>
                                                                    {{- settings.taxFreeShopping == true | yepnope: product.original_net_price, product.original_price | money_with_currency }}
                                                                </span>

                                                            {% else %}

                                                                <span class="product-price text-price me-3" data-product-price-dynamic>
                                                                    {{- settings.taxFreeShopping == true | yepnope: product.net_price, product.price | money_with_currency -}}
                                                                </span>

                                                            {% endif %}

                                                            {% assign itemTaxPercent = settings.taxFreeShopping == true | yepnope: 0, product.rate | round %}

                                                            <span class="product-vat-text text-muted ms-auto">
                                                                {{- 'product.vat_included_dynamic' | t, amount: itemTaxPercent -}}
                                                            </span>

                                                        </div>

                                                        {% if section.settings.showLowestPrice and product.previous_lower_price %}

                                                            {% assign itemLowestPrice = settings.taxFreeShopping == true | yepnope: product.previous_lower_price.net_price, product.previous_lower_price.price | money_with_currency %}

                                                            <div class="product-lowest-price mt-2">
                                                                {{- 'product.lowest_price_dynamic' | t, amount: itemLowestPrice -}}
                                                            </div>

                                                        {% endif %}

                                                    </div>

                                                </div>

                                            {% endif %}

                                            {%- unless showStockBalance and product.inventory_policy == 'deny' and product.only_preview == false -%}
                                                {%- assign showStockBalance = false -%}
                                            {%- endunless -%}

                                            {% if showStockBalance %}

                                                <div class="product-stock-balance mb-4">
                                                    
                                                    <label class="form-label fw-bold me-2 d-block d-md-inline-block min-w-px-100">
                                                        {{- 'product.stock_balance_available' | t -}}:
                                                    </label>

                                                    {% if product.in_stock == false %}

                                                        <span class="product-stock-balance-out-of-stock">
                                                            {{- 'product.out_of_stock' | t -}}
                                                        </span>

                                                    {% elsif product.stock_alarm %}

                                                        <span class="product-stock-balance-low-on-stock">
                                                            {{- 'product.low_on_stock_dynamic' | t: amount: product.stock -}}
                                                        </span>

                                                    {% else %}

                                                        <span class="product-stock-balance-in-stock">
                                                            {{- 'product.in_stock' | t -}}
                                                        </span>

                                                {% endif %}

                                                </div>

                                            {% endif %}

                                            {% if section.settings.showQuantitySelect %}

                                                <div class="product-quantity-container mb-4 d-flex flex-column flex-md-row">

                                                    <label for="product-quantity-input" class="form-label fw-bold me-2 d-inline-block min-w-px-100 mb-md-0">
                                                        {{- 'general.quantity' | t -}}:
                                                    </label>

                                                    <div class="product-inline-quantity max-w-px-120 min-h-px-40 d-inline-flex">

                                                        <button type="button" class="btn btn-text product-quantity-decrease">
                                                            {%- render 'icon', icon: 'subtract' -%}
                                                        </button>

                                                        <input
                                                            type="tel"
                                                            id="product-quantity-input"
                                                            name="quantity"
                                                            class="product-quantity-input"
                                                            value="{{ product.min_amount }}"
                                                            min="{% if product.min_amount %}{{ product.min_amount }}{% else %}1{% endif %}"
                                                            {% if product.max_amount %}max="{{ product.max_amount }}"{% endif %}pattern="[0-9]{1,3}">

                                                        <button type="button" class="btn btn-text product-quantity-increase">
                                                            {%- render 'icon', icon: 'add' -%}
                                                        </button>

                                                    </div>

                                                </div>

                                            {% endif %}

                                            <div class="product-action-add-to-cart d-flex">

                                                <button
                                                    type="button"
                                                    class="btn btn-primary btn-lg d-block w-100"
                                                    data-cart-add
                                                    data-cart-form>
                                                    {{- 'cart.add' | t -}}
                                                </button>

                                                {% if session.logged_in %}

                                                    <button
                                                        type="button"
                                                        class="btn btn-text ms-1 btn btn-text p-2 product-wishlist-action bordered"
                                                        data-wishlist-toggle="{{ product.id }}"
                                                        aria-pressed="{{ product.in_customers_wishlist | yepnope: 'true', 'false' }}">
                                                        {%- render 'icon', icon: 'like', class: 'svg-icon-lg svg-icon-fw' -%}
                                                    </button>

                                                {% endif %}

                                            </div>

                                            {% render 'form-error', error: form.error, class: 'mt-4' %}

                                            {% if settings.klarnaClientId %}

                                                <div class="mt-3">

                                                    {% assign itemPrice = settings.taxFreeShopping == true | yepnope: product.net_price, product.price %}

                                                    {% render 'klarna-placement', type: 'credit-promotion-auto-size', purchaseAmount: itemPrice %}

                                                </div>

                                            {% endif %}

                                        {% endform %}

                                    </div>

                                {% elsif product.inventory_policy == 'deny' and product.in_stock == false and product.only_preview == false %}

                                    <div class="product-form mt-4">

                                        {% if store.customer_accounts_require_approval == false or accountHasApproval %}

                                            <div class="product-pricing mb-4 d-md-flex">

                                                <label class="form-label fw-bold me-2 d-inline-block min-w-px-100">
                                                    {{- 'general.price' | t -}}:
                                                </label>

                                                <div class="w-100">

                                                    {% if showPromotion %}

                                                        <div class="product-promotion mb-2">
                    
                                                            <span class="text-sale-price">
                                                                {{ product.promotion.title | strip }}{% if product.promotion.description %}: {{ product.promotion.description }}{% endif %}
                                                            </span>
                    
                                                        </div>
                    
                                                    {% endif %}

                                                    <div class="product-price-container d-flex">

                                                        {% if product.has_discount %}

                                                            <span class="product-sale-price-text text-sale-price fw-bold me-3" data-product-price-dynamic>
                                                                {{ settings.taxFreeShopping == true | yepnope: product.net_price, product.price | money_with_currency }}
                                                            </span>

                                                            <span class="product-price text-decoration-line-through text-muted me-3" data-product-original-price-dynamic>
                                                                {{ settings.taxFreeShopping == true | yepnope: product.original_net_price, product.original_price | money_with_currency }}
                                                            </span>

                                                        {% else %}

                                                            <span class="product-price text-price me-3" data-product-price-dynamic>
                                                                {{ settings.taxFreeShopping == true | yepnope: product.net_price, product.price | money_with_currency }}
                                                            </span>

                                                        {% endif %}

                                                        {% assign itemTaxPercent = settings.taxFreeShopping == true | yepnope: 0, product.rate | round %}

                                                        <span class="product-vat-text text-muted ms-auto">
                                                            {{- 'product.vat_included_dynamic' | t, amount: itemTaxPercent -}}
                                                        </span>

                                                    </div>

                                                    {% if section.settings.showLowestPrice and product.previous_lower_price %}

                                                        {% assign itemLowestPrice = settings.taxFreeShopping == true | yepnope: product.previous_lower_price.net_price, product.previous_lower_price.price | money_with_currency %}

                                                        <div class="product-lowest-price mt-2">
                                                            {{- 'product.lowest_price_dynamic' | t, amount: itemLowestPrice -}}
                                                        </div>

                                                    {% endif %}

                                                </div>

                                            </div>

                                        {% endif %}

                                        <div class="product-info-out-of-stock">

                                            <span class="product-info-out-of-stock-text btn btn-primary d-block w-100 disabled">
                                                {{- 'product.out_of_stock' | t -}}
                                            </span>

                                        </div>

                                    </div>

                                {% endif %}

                            {% endif %}

                        {% endif %}

                        {% if product.short_description %}

                            <div class="product-short-description mt-4">

                                <span>{{ product.short_description }}</span>

                            </div>

                        {% endif %}

                        {% if product.bulkrates %}

                            <div class="product-bulk-discounts mt-4">

                                <div class="product-bulk-discount-header row g-0">

                                    <div class="col-6">

                                        <span class="product-bulk-discount-info-text">
                                            {{- 'product.bulk_discount' | t -}}
                                        </span>

                                    </div>

                                    <div class="col-6">

                                        <span class="product-bulk-discount-info-text">
                                            {{- 'product.discount_rate' | t -}}
                                        </span>

                                    </div>

                                </div>

                                {% for rate in product.bulkrates %}

                                    {% if rate.is_percentage %}

                                        <div class="product-bulk-discount-item row g-0">

                                            <div class="col-6">

                                                <span class="product-bulk-discount-rate-quantity-text">
                                                    {% if rate.quantity > 1 %}+
                                                    {% endif %}
                                                    {{ rate.quantity }} {{ product.unit }}
                                                </span>

                                            </div>

                                            <div class="col-6">

                                                <span class="product-bulk-discount-rate-amount-text">
                                                    {{ rate.amount }} %
                                                </span>

                                            </div>

                                        </div>

                                    {% endif %}

                                {% endfor %}

                            </div>

                        {% endif %}

                        {% if product.deliverytime and product.deliverytime.max.days > 0 %}

                            <div class="product-delivery-time d-flex mt-4">

                                {%- render 'icon', icon: 'delivery-time', class: 'svg-icon-fw svg-icon-lg' -%}

                                <span class="ms-2">
                                    {{- 'product.delivery_time_dynamic' | t: min_days: product.deliverytime.min.days, max_days: product.deliverytime.max.days -}}
                                </span>

                            </div>

                        {% endif %}

                        {% if product.returntime and product.returntime.days %}

                            <div class="product-return-time d-flex mt-4">

                                {%- render 'icon', icon: 'arrow-return', class: 'svg-icon-fw svg-icon-lg' -%}

                                <span class="ms-2">
                                    {{- 'product.return_time_dynamic' | t: days: product.returntime.days -}}
                                </span>

                            </div>

                        {% endif %}

                    </div>

                </div>

                {% if product.description %}

                    <div class="col mt-4 mt-md-g">

                        <div class="section-highlight-item product-description" data-aos="{{ settings.sectionAnimation }}">

                            {%- assign descriptionTitle = 'product.description' | t -%}

                            {% render 'section-header', sectionTitle: descriptionTitle, sectionHeaderContainer: 'none', sectionAnimation: false %}

                            <div class="mt-4">
                                {{ product.description }}
                            </div>

                        </div>

                    </div>

                {% endif %}

                {% if product.reviews_are_enabled %}

                    <div class="col mt-4 mt-md-g">

                        <div class="section-highlight-item product-reviews" data-aos="{{ settings.sectionAnimation }}">

                            {%- assign reviewsTitle = 'product.reviews' | t -%}

                            {% render 'section-header', sectionTitle: reviewsTitle, sectionHeaderContainer: 'none', sectionAnimation: false %}

                            <div class="d-flex align-items-center mt-1">

                                <div class="product-review-icons">

                                    {% for rating in (1..product.max_rating) %}

                                        <div class="product-review-icon">

                                            {% if product.rating >= rating %}

                                                {%- render 'icon', icon: 'rating', class: 'text-review-icon' -%}

                                            {% else %}

                                                {%- render 'icon', icon: 'rating-empty', class: 'text-muted' -%}

                                            {% endif %}

                                        </div>

                                    {% endfor %}

                                </div>

                                <span class="ms-2">
                                    {%- if product.review_count == 1 -%}
                                        {{- 'product.review_count_dynamic' | t: amount: product.review_count -}}
                                    {%- else -%}
                                        {{- 'product.review_count_plural_dynamic' | t: amount: product.review_count -}}
                                    {%- endif -%}
                                </span>

                            </div>

                            {% if product.reviews_are_enabled %}

                                <div class="mt-4 mt-md-g" data-aos="{{ settings.sectionAnimation }}">

                                    {% if product.customer_can_review %}

                                        <button id="product-review-create" class="btn btn-sm btn-secondary{% if submitted_form.id == 'product-review-form' and submitted_form.error %} d-none{% endif %}">
                                            {{- 'product.write_review' | t -}}
                                        </button>

                                        <div class="product-review-form{% unless submitted_form.id == 'product-review-form' and submitted_form.error %} d-none{% endunless %}">

                                            {% form 'review', product id: 'product-review-form' %}

                                                <div class="mb-4 form-floating">

                                                    <input
                                                        name="name"
                                                        type="text"
                                                        id="product-review-name"
                                                        class="form-control"
                                                        placeholder="{{ 'general.name' | t }}"
                                                        value="{{ form.submitted.name | escape }}"
                                                        required>

                                                    <label for="product-review-name">
                                                        {{- 'general.name' | t -}}
                                                    </label>

                                                </div>

                                                <div class="mb-4 form-floating">

                                                    <input
                                                        name="title"
                                                        type="text"
                                                        id="product-review-title"
                                                        class="form-control"
                                                        placeholder="{{ 'general.title' | t }}"
                                                        value="{{ form.submitted.title | escape }}"
                                                        required>

                                                    <label for="product-review-title">
                                                        {{- 'general.title' | t -}}
                                                    </label>

                                                </div>

                                                <div class="mb-4 form-floating">

                                                    <textarea
                                                        id="product-review-comment"
                                                        name="comment"
                                                        class="form-control"
                                                        placeholder="{{ 'product.write_review' | t }}"
                                                        value="{{ form.submitted.comment | escape }}"
                                                        required></textarea>

                                                    <label for="product-review-comment">
                                                        {{- 'product.write_review' | t -}}
                                                    </label>

                                                </div>

                                                <div class="mb-4 d-flex justify-content-between align-items-center">

                                                    <span class="h5 mb-0">
                                                        {{- 'product.review_grade' | t -}}
                                                    </span>

                                                    <fieldset class="product-review-rating ms-2">

                                                        <input
                                                            type="radio"
                                                            id="product-review-rating-5"
                                                            name="rating"
                                                            value="5"
                                                            {% if form.submitted.rating | escape == '5' %}checked{% endif %}>
                                                        <label for="product-review-rating-5" title="5">
                                                            {%- render 'icon', icon: 'rating', class: 'svg-icon-fill' -%}
                                                        </label>

                                                        <input
                                                            type="radio"
                                                            id="product-review-rating-4"
                                                            name="rating"
                                                            value="4"
                                                            {% if form.submitted.rating | escape == '4' %}checked{% endif %}>
                                                        <label for="product-review-rating-4" title="4">
                                                            {%- render 'icon', icon: 'rating', class: 'svg-icon-fill' -%}
                                                        </label>

                                                        <input
                                                            type="radio"
                                                            id="product-review-rating-3"
                                                            name="rating"
                                                            value="3"
                                                            {% if form.submitted.rating | escape == '3' %}checked{% endif %}>
                                                        <label for="product-review-rating-3" title="3">
                                                            {%- render 'icon', icon: 'rating', class: 'svg-icon-fill' -%}
                                                        </label>

                                                        <input
                                                            type="radio"
                                                            id="product-review-rating-2"
                                                            name="rating"
                                                            value="2"
                                                            {% if form.submitted.rating | escape == '2' %}checked{% endif %}>
                                                        <label for="product-review-rating-2" title="2">
                                                            {%- render 'icon', icon: 'rating', class: 'svg-icon-fill' -%}
                                                        </label>

                                                        <input
                                                            type="radio"
                                                            id="product-review-rating-1"
                                                            name="rating"
                                                            value="1"
                                                            {% if form.submitted.rating | escape == '1' %}checked{% endif %}>
                                                        <label for="product-review-rating-1" title="1">
                                                            {%- render 'icon', icon: 'rating', class: 'svg-icon-fill' -%}
                                                        </label>

                                                    </fieldset>

                                                </div>

                                                {% render 'form-error', error: form.error, class: 'mb-4' %}

                                                <div class="mb-4 text-end">

                                                    <button
                                                        type="button"
                                                        id="product-review-cancel"
                                                        class="btn btn-secondary">{{ 'general.cancel' | t }}</button>

                                                    <button type="submit" class="btn btn-primary">{{ 'general.submit' | t }}</button>

                                                </div>

                                            {% endform %}

                                        </div>

                                    {% elsif session.logged_in == false and product.reviews_require_account %}

                                        {%- capture loginLink -%}<a href="{{ 'login' | link }}" class="fw-bold text-underline-indicator">
                                            {{- 'product.review_account_required_link_text' | t -}}
                                        </a>{%- endcapture -%}

                                        <span>
                                            {{- 'product.review_account_required' | t, link: loginLink -}}
                                        </span>

                                    {% elsif product.customer_has_purchased == false and product.reviews_require_purchase %}

                                        <span>
                                            {{- 'product.review_purchase_required' | t -}}
                                        </span>

                                    {% elsif product.customer_has_reviewed %}

                                        {% if product.reviews_require_approval %}

                                            <span>
                                                {{- 'product.review_publish_pending' | t -}}
                                            </span>

                                        {% else %}

                                            <span>
                                                {{- 'product.review_already_given' | t -}}
                                            </span>

                                        {% endif %}

                                    {% endif %}

                                </div>

                            {% endif %}

                            <div class="product-reviews-content{% if product.reviews.size > 0 %} has-content{% endif %}" data-aos="{{ settings.sectionAnimation }}">

                                {% for review in product.reviews %}

                                    <div class="product-review pt-4 border-top">

                                        <div class="product-review-title mb-0">

                                            <span class="product-review-title">
                                                {{ review.name }}
                                            </span>

                                        </div>

                                        <div class="product-review-date">

                                            {%- assign dateFormat = 'general.date_format' | t -%}

                                            <i>
                                                <time datetime="{{ review.created_at | date: "%F" }}">{{ review.created_at | date: dateFormat }}</time>
                                            </i>

                                        </div>

                                        <div class="product-review-rating">

                                            <div class="product-review-icons">

                                                {% for rating in (1..product.max_rating) %}

                                                    <div class="product-review-icon">

                                                        {% if review.rating >= rating %}

                                                            {%- render 'icon', icon: 'rating', class: 'text-review-icon' -%}

                                                        {% else %}

                                                            {%- render 'icon', icon: 'rating-empty', class: 'text-muted' -%}

                                                        {% endif %}

                                                    </div>

                                                {% endfor %}

                                            </div>

                                        </div>

                                        <div class="product-review-content">

                                            <p class="mb-0">
                                                <strong>{{ review.title }}</strong>
                                            </p>

                                            {{ review.review }}

                                        </div>

                                    </div>

                                {% endfor %}

                            </div>
                            
                        </div>

                    </div>

                {% endif %}

                {% if product.attachments.size %}

                    <div class="col mt-4 mt-md-g">

                        <div class="section-highlight-item product-attachments" data-aos="{{ settings.sectionAnimation }}">

                            {%- assign attachmentsTitle = 'product.attachments' | t -%}

                            {% render 'section-header', sectionTitle: attachmentsTitle, sectionHeaderContainer: 'none', sectionAnimation: false %}

                            {% for attachment in product.attachments %}

                                <div class="mt-4 border-top">

                                    <a href="{{ attachment.href }}" class="d-flex align-items-center">

                                        {%- render 'icon', icon: 'download', class: 'svg-icon-2x' -%}

                                        <span class="ms-3">{{ attachment.name }}</span>
                                    </a>

                                </div>

                            {% endfor %}

                        </div>

                    </div>

                {% endif %}

            </div>

        </div>

        {% if product.similar.size > 0 or request.design_mode %}

            {%- assign carouselTitle = 'product.similar_products' | t -%}
            {%- assign carouselSectionHandle = '#finqu-section-' | append: section.id -%}

            <div class="mt-4 mt-md-g">

                {% render 'section-header', sectionTitle: carouselTitle, sectionHeaderContainer: 'none' %}

                <div class="product-carousel mt-4">
                    {% render 'product-carousel', items: product.similar, sectionHandle: carouselSectionHandle, carouselFreemode: true %}
                </div>

            </div>

        {% endif %}

        {% if product.compatible.size > 0 or request.design_mode %}

            {%- assign carouselTitle = 'product.compatible_products' | t -%}
            {%- assign carouselSectionHandle = '#finqu-section-' | append: section.id -%}

            <div class="mt-4 mt-md-g">

                {% render 'section-header', sectionTitle: carouselTitle, sectionHeaderContainer: 'none' %}

                <div class="product-carousel mt-4">
                    {% render 'product-carousel', items: product.compatible, sectionHandle: carouselSectionHandle, carouselFreemode: true %}
                </div>

            </div>

        {% endif %}

        <script type="application/javascript">
            document.addEventListener('DOMContentLoaded', function() {
            document.dispatchEvent(new CustomEvent('theme:product:view', {
                detail: {
                    id: {{ product.id | json }},
                    {%- if store.customer_accounts_require_approval == false or accountHasApproval -%}
                        price: {{ product.price | json }},
                    {%- else -%}
                        price: null,
                    {%- endif -%}
                    name: {{ product.name | json }},
                    manufacturer: {{ product.manufacturer.name | json }},
                    currency: {{ store.currency.iso_code | json }}
                }
            }));
                                                                        });
        </script>

    {% endif %}

{%- endcapture -%}

{% if request.uri contains 'create_review=true' and product.customer_has_reviewed == false and product.reviews_are_enabled %}

    {%- assign sectionTitle = 'product.write_product_review' | t -%}
    {%- assign sectionSubtitle = product.name -%}

    {% render 'section', section: section, sectionTitle: sectionTitle, sectionSubtitle: sectionSubtitle, sectionContent: sectionContent, sectionContainer: 'tiny', sectionContentOverflow: 'clip'  %}

{% else %}

    {% if section.settings.showBreadcrumbs %}
        {%- assign sectionBreadcrumbs = product.breadcrumbs -%}
    {% endif %}

    {% render 'section', section: section, sectionContent: sectionContent, sectionBreadcrumbs: sectionBreadcrumbs, sectionContentAnimation: false %}

{% endif %}

{%- if settings.schemaProduct -%}
    {% render 'schemas/product', product: product %}
{%- endif -%}

{%- if settings.schemaBreadcrumbList -%}
    {% render 'schemas/breadcrumblist', breadcrumbs: product.breadcrumbs, currentItem: product %}
{%- endif -%}

{% schema %}
{
    "name": {
        "en": "Product",
        "fi": "Tuote"
    },
    "tag": "div",
    "class": "section section-product",
    "is_creatable": false,
    "settings": {
        "list_type": "tabs",
        "groups": [
            {
                "title": {
                    "en": "Settings",
                    "fi": "Asetukset"
                },
                "settings": [
                    {
                        "id": "showBreadcrumbs",
                        "type": "checkbox",
                        "label": {
                            "en": "Show breadcrumbs",
                            "fi": "Nyt leivnmuru"
                        },
                        "default": true
                    },
                    {
                        "id": "showQuantitySelect",
                        "type": "checkbox",
                        "label": {
                            "en": "Show quantity select",
                            "fi": "Nyt mrvalinta"
                        },
                        "default": false
                    },
                    {
                        "id": "showProductOptionPrice",
                        "type": "checkbox",
                        "label": {
                            "en": "Show product option price",
                            "fi": "Nyt tuotevalinnan hinta"
                        },
                        "default": true
                    },
                    {
                        "id": "showProductOptionTotalPrice",
                        "type": "checkbox",
                        "label": {
                            "en": "Show total price of the product and product option in the product option",
                            "fi": "Nyt tuotevalinnassa tuotteen ja tuotevalinnan yhteishinta"
                        },
                        "default": false
                    },
                    {
                        "id": "showProductOptionStockBalance",
                        "type": "checkbox",
                        "label": {
                            "en": "Show product option stock balance",
                            "fi": "Nyt tuotevalinnan varastosaldo"
                        },
                        "default": false
                    },
                    {
                        "id": "showLowestPrice",
                        "type": "checkbox",
                        "label": {
                            "en": "Show the last 30 days lowest sale price",
                            "fi": "Nyt viimeisen 30 pivn alin myyntihinta"
                        },
                        "default": true
                    },
                    {
                        "id": "customDisplayInformation",
                        "type": "checkbox",
                        "label": {
                            "en": "Select product information to display",
                            "fi": "Valitse nytettvt tuotetiedot"
                        },
                        "default": false
                    },
                    {
                        "id": "showManufacturer",
                        "type": "checkbox",
                        "label": {
                            "en": "Show manufacturer",
                            "fi": "Nyt valmistaja"
                        },
                        "default": true,
                        "conditions": ["customDisplayInformation eq true"]
                    },
                    {
                        "id": "showPromotion",
                        "type": "checkbox",
                        "label": {
                            "en": "Show promotion",
                            "fi": "Nyt kampanja"
                        },
                        "default": true,
                        "conditions": ["customDisplayInformation eq true"]
                    },
                    {
                        "id": "showNewBadge",
                        "type": "checkbox",
                        "label": {
                            "en": "Show new badge",
                            "fi": "Nyt uutuusmerkki"
                        },
                        "default": true,
                        "conditions": ["customDisplayInformation eq true"]
                    },
                    {
                        "id": "showDiscountBadge",
                        "type": "checkbox",
                        "label": {
                            "en": "Show discount badge",
                            "fi": "Nyt alennusmerkki"
                        },
                        "default": true,
                        "conditions": ["customDisplayInformation eq true"]
                    },
                    {
                        "id": "showOutOfStockBadge",
                        "type": "checkbox",
                        "label": {
                            "en": "Show out of stock badge",
                            "fi": "Nyt loppumerkki"
                        },
                        "default": true,
                        "conditions": ["customDisplayInformation eq true"]
                    },
                    {
                        "id": "showStockBalance",
                        "type": "checkbox",
                        "label": {
                            "en": "Show stock balance",
                            "fi": "Nyt saatavuus"
                        },
                        "default": true,
                        "conditions": ["customDisplayInformation eq true"]
                    }
                ]
            }
        ]
    }
}
{% endschema %}